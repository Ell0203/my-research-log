---
title: 💬 카카오톡 대화 분석기 (보안 & 로컬 중심) 구현
date: "2026-02-22"
tags: ["Python", "Pandas", "Gemini", "Privacy", "Data Analysis"]
---

카카오톡이나 텔레그램에서 내보낸 대화 기록 파일(`.txt`)을 파싱하여 누가 이야기를 많이 했는지, 대화가 언제 활발한지, 어떤 단어를 주로 사용하는지 `pandas`를 이용해 통계를 내는 Python 도구입니다. 이와 함께 **Gemini API**를 활용하여 재미있는 "분위기(Vibe) 및 관계 요약" 리포트를 생성합니다. (Project: `06_chat_analyzer`)

*   🎯 **Target**: 카카오톡 / 텔레그램 내보내기 파일 (`.txt`)
*   🤖 **AI Engine**: Google Gemini (`gemini-2.5-flash`) - 대화 분위기 및 관계 프로파일링
*   🔒 **보안**: 100% 로컬 통계 처리 + PII 완벽 마스킹 후 AI 전송

<!-- more -->

## 🏗️ 1. 개발된 모듈 구조 (`projects/06_chat_analyzer/`)

### 📦 `requirements.txt`
분석기 실행에 필요한 종속성 패키지입니다.
- `pandas` (데이터 조작 및 통계)
- `requests` (Gemini API 호출용, `02_news_bot`과 동일한 구도)
- (선택 사항: 향후 고급 형태소 분석이나 차트를 위해 `konlpy` 또는 `matplotlib` 추가 가능)

### 📄 `parser.py`
`.txt` 형식의 내보내기 파일을 읽어 들이는 모듈입니다.
- 카카오톡 내보내기 형식에 맞춘 커스텀 정규표현식(Regex)을 포함합니다. *카카오톡 PC버전 및 모바일 버전 내보내기 형식을 모두 지원합니다.*
- 텍스트 줄을 파싱하고, 여러 줄로 나뉜 메시지를 하나로 묶어 구조화된 `pandas.DataFrame`(컬럼: 일자, 시간, 발신자, 메시지)으로 변환합니다.

### 📊 `analyzer.py`
데이터프레임(DataFrame)을 기반으로 통계 지표를 계산합니다.
- 🗣️ **메시지 수:** 발신자별 총 메시지 개수 파악.
- ⏰ **시간대 분석:** 하루 중 가장 대화가 활발한 시간 파악.
- 🔠 **단어 빈도수:** 가장 자주 등장하는 단어 추출 (조사, 이모티콘 등 일반적인 불용어 필터링).

### 🔒 `anonymizer.py`
가장 중요한 보안 모듈로써, 외부 API 서버에 데이터를 보내기 전 모든 개인정보를 철저하게 마스킹합니다.
- `analyzer.py` 이후에 동작하여 데이터프레임을 클렌징합니다.
- 👤 **표시 이름 마스킹:** 실제 대화명을 `User_A`, `User_B` 등으로 대체합니다.
- 🛡️ **정규식 치환(Redaction):** 1) 이메일 주소(`[EMAIL]`), 2) 전화번호, 계좌번호, 카드번호(`[NUMBER]`), 3) 패턴 상 ID/패스워드로 추정되는 정보들을 정규식으로 찾아내 [마스킹 텍스트]로 치환합니다.
- ✅ 이 과정을 통해 사용자 컴퓨터(로컬)를 떠나는 데이터에는 어떠한 개인 식별 정보(PII)도 포함되지 않습니다.

### 🤖 `ai_summarizer.py`
Gemini API와 통신하는 클래스입니다.
- 환경 변수나 설정 파일에서 API 키를 로드하여 사용합니다.
- 개인정보가 완벽히 제거된 대화 기록(예: 최근 300개의 메시지 등)만을 샘플링합니다.
- 대화의 주요 주제 3가지 및 참여자 간의 관계나 분위기(Vibe), 감정 상태 등을 분석해달라는 프롬프트를 전송합니다.
- 잘 정리된 Markdown 형식의 문자열 리포트를 반환받습니다.

### ▶️ `main.py`
모든 모듈을 조율하는 메인 스크립트입니다.
- 터미널에서 채팅 로그 파일(`.txt`) 경로를 인자로 받습니다. `--days` 옵션을 통해 분석할 기간(최근 N일)을 유연하게 조정할 수 있습니다.
- `parser.py` -> `analyzer.py` -> `anonymizer.py` -> `ai_summarizer.py` 순서로 파이프라인을 실행합니다.
- 작업 완료 후, 통계 분석과 AI 요약이 담긴 `chat_report.md` 결과물 파일을 깔끔하게 생성합니다.

### ⚙️ `config.py`
- Gemini API 키 및 모델 파라미터 설정을 관리합니다.
- 한도 및 속도 효율이 뛰어난 최신 `gemini-2.5-flash` 모델을 기본으로 사용합니다.

---

> 🔒 **보안 알림:** 이 프로젝트는 사용자의 개인 정보 보안을 최우선으로 합니다. 단어 빈도수나 활동 시간 같은 모든 통계는 로컬(사용자 PC) 오프라인 상태에서 안전하게 처리되며, 철저한 패턴 마스킹(Anonymization)을 거친 문자 조합만이 AI 분석의 재료로 외부 전송됩니다.
